# Documents, Fields, 和Schema设计概述 

Solr 的基本前提很简单。您给它很多的信息，然后你可以问问题并找到你想要的信息。您在所有信息中提供的内容称为索引或更新。当你问一个问题时，它被称为查询。  

可以把Solr想像成一本食谱,每次向书中添加配方时，都会更新后面的索引。您列出了每个成分和刚刚添加的配方的页码。假设您添加了一百个食谱。使用该索引，您可以非常快速地找到所有使用鹰嘴豆，朝鲜蓟或咖啡作为成分的食谱。使用索引要比逐个查看每个配方快得多。想象一本有一千种食谱的书，或一百万份。

Solr 允许你建立一个包含许多不同字段或条目类型的索引。上面的例子展示了如何用一个字段来构建索引：ingredients。你可以在为配方的烹饪风格指数等多个领域，像 Asian，Cajun 或者 vegan，你可以有一个索引字段的准备时间。Solr 可以回答这样的问题，比如：“在不到30分钟的时间内，可以准备哪些以血橙为原料的 Cajun 式食谱？
Schema是您告诉 Solr 如何从输入文档建立索引的地方。

## Solr 如何看待文档

Solr 的基本信息单元是一个文档(Documents)，它是描述某些东西的一组数据。例如：配方文件将包含成分、说明、准备时间、烹饪时间、所需的工具等等。例如，关于一个人的文档可能包含该人的姓名、传记、最喜欢的颜色和鞋子大小。关于一本书的文档可能包含标题、作者、出版年份、页数等等。

在Solr中，文档由字段组成，这些字段是更具体的信息片段。我们比喻的鞋子的大小可以是一个字段(Fields)，名字和姓氏也可以看成字段(Fields)。

字段Fields可以包含不同类型的数据。例如，名称字段是文本（字符数据）。鞋号字段可能是一个浮点数，以便它可以包含像6和9.5 这样的值。显然，字段的定义是非常灵活的（例如，您可以将鞋号字段定义为文本字段而不是浮点数），但是如果您正确定义字段，Solr 将能够正确解释它们，并且您的用户在执行查询时会得到更好的结果。

您可以通过指定字段类型来告诉 Solr 字段包含的数据类型。字段类型告诉Solr如何解释字段以及如何查询。

添加文档时，Solr会获取文档字段中的信息，并将该信息添加到索引中。执行查询时，Solr可以快速查阅索引并返回匹配的文档。

## 字段Fields分析(分词)

字段分析告诉Solr在构建索引时如何处理传入数据。这个过程的一个更准确的名字是处理（processing），甚至消化（digestion），但官方名称是分析。

例如，考虑个人文档中的传记字段。传记中的每个单词都必须编入索引，以便您可以快速找到生活与番茄酱，蜻蜓或加密有关的人。

然而，一本传记可能会包含很多你不关心的词，也不希望堵塞你的索引词，比如 “the”、“a”、“to” 等等。此外，假设传记中包含“Ketchup”一词，在句首是大写的。如果用户对 “Ketchup” 进行查询，即使传记包含大写的单词，您也希望 Solr 告诉你有关此人的信息。

这两个问题的解决方案是Fields分析。对于传记字段，你可以告诉Solr如何将传记分解成文字。您可以告诉Solr你想让所有的单词小写，你可以告诉Solr删除重音符号。

字段分析是字段类型的重要组成部分。"[分词器、标记器和过滤器](solr_doc_fenxiqibiaojiqiheguolvqi.md)"一节是对字段分析的详细描述。  

## Schema文件

 schema是用来告诉solr如何建立索引的，它的配置围绕着一个schema配置文件，这个配置文件决定着solr如何建立索引，每个字段的数据类型，分词方式等.Schema文件的名称和位置可能会有所不同，具体取决于Solr配置:

- managed-schema 是Solr默认使用的Schema文件的名称，它支持在运行时通过[Schema API](solr_doc_dejiagouapi.md) 或 [Schemaless Mode](solr_doc_schemaless.md) 功能进行更改,这种方式修改不需要重新加载core或者重启solr。如果使用手工编辑的方式更改配置不进行重加载core有可能会造成配置丢失。
- schema.xml 是模式文件的旧版名称，可以由使用该模式的用户手动编辑ClassicIndexSchemaFactory。
- 如果您使用的是 SolrCloud，则您可能无法通过本地文件系统上的这些名称找到任何文件。您将只能通过 Schema API（如果已启用）或通过 Solr 管理界面的Cloud Screens 来查看。

无论您的安装中使用的文件的名称是什么，文件的结构都不会改变。但是，与文件交互的方式将会改变。如果您正在使用托管模式，则只能使用 Schema API 与文件进行交互，而不要进行手动编辑。如果您不使用托管模式，则只能对该文件进行手动编辑，而 Schema API 将不支持任何修改。

请注意，如果您没有使用 Schema API，但使用了 SolrCloud，则需要与 schema.xml 进行交互，通过 ZooKeeper 使用 upconfig 和 downconfig 命令来创建一个本地副本并上传您的更改。“ Solr 控制脚本参考”和 “使用 ZooKeeper管理配置文件”中介绍了执行此操作的选项。
